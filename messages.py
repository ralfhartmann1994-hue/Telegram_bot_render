

# =================
# messages.py (محسن مع رسائل مضحكة)
# =================
import random
import time
from stickers import STICKERS

# Messages constants (عربي)
WELCOME = "🎉 مرحبًا بك! استخدم الأزرار للبدء."
HELP = (
    "🆘 <b>مساعدة</b>\n"
    "• 👤 ملفي — عرض بياناتك.\n"
    "• ✏️ تعديل الاسم / 🎂 تعديل العمر.\n"
    "• 🔍 البحث عن دردشة — تختار موضوعًا + جنس الطرف الآخر ثم نبحث لمدة 30 دقيقة.\n"
    "• أثناء الدردشة: 🚨 إبلاغ، 🚪 مغادرة (بعد 30 ثانية) مع تأكيد.\n"
)

WELCOME_MESSAGE = "👋 أهلاً بك في البوت!"
ASK_NAME = "ما اسمك؟"
ASK_GENDER = "اختر جنسك:"
ASK_AGE = "كم عمرك؟"

PROFILE_SAVED = """✅ تم حفظ ملفك الشخصي بنجاح!

👤 <b>معلوماتك:</b>
• الاسم: {name}
• الجنس: {gender}
• العمر: {age}

🎉 مبروك! أصبح بإمكانك الآن البحث عن شركاء للدردشة!"""

SEARCHING = "🔍 جاري البحث عن شريك مناسب لك...\n⏰ قد يستغرق الأمر حتى 30 دقيقة\n💡 يمكنك العودة للقائمة وسنخبرك فور العثور على شريك!"
NO_MATCH = "😔 للأسف لم نجد شريكًا مناسبًا خلال فترة البحث.\n🔄 لا تيأس! جرب مرة أخرى - ربما تجد الشخص المناسب هذه المرة."
INTRO_PARTNER = (
    "🎊 <b>رائع! تم العثور على شريك للدردشة!</b>\n\n"
    "📋 <b>قواعد المحادثة:</b>\n"
    "• احترم الطرف الآخر وكن مهذبًا\n"
    "• لا تشارك معلومات شخصية حساسة\n"
    "• استمتع بمحادثة ممتعة وآمنة\n\n"
    "💬 ابدأ بـ'السلام عليكم' أو 'مرحبا' واستمتع! 😊"
)

LEAVE_CONFIRM = "🤔 متأكد إنك تريد تترك الدردشة؟\n\n🔄 يمكنك البحث عن شريك جديد بعد المغادرة\n\nاختر: نعم ✅ أو لا ❌"
LEAVE_TOO_SOON = "⏰ صبر شوية! يجب الانتظار {remain} ثانية إضافية قبل المغادرة.\n💡 هذا يساعد في منع إساءة الاستخدام."
LEFT_YOU = "👋 تم إنهاء الدردشة بنجاح. عدت إلى القائمة الرئيسية.\n🔍 يمكنك البحث عن دردشة جديدة متى شئت!"
LEFT_PARTNER = "😕 للأسف أنهى شريكك المحادثة.\n🔍 لا تقلق! يمكنك البحث عن شريك جديد الآن."

REPORT_CONFIRM = "🚨 <b>تأكيد البلاغ</b>\n\nهل تريد فعلاً إرسال بلاغ لمراجعة آخر رسائل شريكك؟\n\n⚠️ البلاغات الكاذبة قد تؤثر على حسابك أيضاً.\n\nاختر: نعم ✅ أو لا ❌"
REPORT_OK = "✅ تم استلام البلاغ وإرساله لفريق المراجعة.\n🔍 سنقوم بمراجعة الرسائل وإتخاذ الإجراء المناسب."
REPORT_RESULT = """📊 <b>نتيجة مراجعة البلاغ:</b>

📝 الرسائل المراجعة: {lines}
🚫 الكلمات المسيئة المكتشفة: {badwords}
⬇️ النقاط المخصومة: {penalty}
⭐ احترام الشريك الآن: {new_respect}

{'🔨 تم حظر المستخدم نهائياً!' if new_respect <= 25 else '⏰ تم كتم المستخدم مؤقتاً!' if new_respect <= 40 else '✅ تم اتخاذ إجراء تأديبي.'}"""

MUTED = "🔇 <b>حساب مكتوم</b>\n\n⏰ أنت مكتوم حالياً لمدة {left} ثانية بسبب مخالفة قواعد المجتمع.\n\n📖 راجع قواعد الاستخدام وتجنب الكلمات المسيئة."
BANNED = "🚫 <b>حساب محظور</b>\n\n😞 تم حظر حسابك نهائياً بسبب مخالفات متكررة لقواعد المجتمع.\n\n📞 للاستفسار تواصل مع الدعم: @MAA2857"

# رسائل ترحيبية عامة مضحكة ومتنوعة
START_MESSAGES = [
    "😂 أهلين أهلين! دخلت عالم الدردشة العشوائية... خليك جاهز لكل شي!",
    "🎭 مرحبا بك في مسرح الحياة الرقمي! هنا كل شخص ممثل... والسؤال: مين الأصدق؟",
    "🎪 دخلت السيرك الإلكتروني! استعد للضحك، البكاء، والندم أحياناً 😄",
    "🎲 حياك الله! هذا البوت مثل صندوق الشوكولاتة... ما تدري شو رح تطلعلك!",
    "🚀 أهلاً بالمغامر الجديد! رحلتك في عالم الدردشة العشوائية بدأت... شد حزام الأمان!",
    "🎯 وصلت للمكان الصح إذا كنت تدور على دردشة... أو المكان الغلط إذا كنت تدور على الهدوء 😜",
    "🎪 مرحباً بك في كرنفال الشخصيات! كل دقيقة مفاجأة جديدة!",
    "🎳 سترايك! دخلت عالم الدردشة... بس انتبه ما تطيح في الجتر 😅",
    "🎨 أهلاً بالفنان! هنا رح ترسم أجمل (وأغرب) اللوحات الحوارية!",
    "🎪 تفضل تفضل! عرض الدردشة العشوائية بدأ... التذاكر مجانية بس الندم غالي! 😂",
    "🎭 مسرح الحياة مفتوح! كل واحد يلعب دوره... المهم تعرف تميز الأدوار الحقيقية!",
    "🎪 حياك في أكبر سيرك إلكتروني! هنا البشر أغرب من الحيوانات المدربة! 😄"
]

# رسائل رياضية مضحكة
FOOTBALL_MESSAGES = [
    "⚽ يلا نشوف... ريال مدريد ولا برشلونة؟ (وإذا قلت الأهلي رح أحترمك أكتر 😂)",
    "🏆 أهلاً بأسطورة الكرة! بتتوقع مين رح ياخد البطولة هالسنة؟",
    "⚽ دخل خبير الكرة! حضر الشاي والمكسرات، النقاش رح يطول 😄",
    "🥅 جووووول في الدردشة! مرحبا بعاشق الكرة الجديد!",
    "⚽ كرة قدم؟ يعني استعد لنقاش من النوع الثقيل... مع احتمال شجار ودي 😂",
    "🏟️ أهلاً بك في الملعب الإلكتروني! هنا الكلام أخطر من التدخلات القوية!",
]

# رسائل سياسية (حساسة لكن مضحكة)
POLITICS_MESSAGES = [
    "🗳️ أوه... دخل المحلل السياسي! استعد لنقاش حار (وممكن نار 🔥)",
    "🌍 السياسة؟ يعني بدك تناقش أصعب مواضيع الكون... الله يعينك!",
    "🏛️ أهلاً بالسياسي الجديد! بس ما تخليني أندم إني فتحت هالموضوع 😅",
    "📊 سياسة؟ طيب خلينا نتفق نختلف بأدب... أو على الأقل نحاول 😂",
    "🗺️ دخلت حقل الألغام السياسي! خطوة غلط وبتنفجر الدردشة 💥",
]

# رسائل دينية محترمة
RELIGION_MESSAGES = [
    "🕌 أهلاً وسهلاً... موضوع الدين يحتاج حكمة واحترام للجميع 🤲",
    "📿 حياك الله... هنا نتكلم بالدين بأدب واحترام لكل الأديان",
    "☪️ السلام عليكم... موضوع روحاني جميل، بإذنك نخليه حوار بناء",
    "🕊️ أهلاً بك... الدين موضوع عميق، يلا نغوص بالمعاني الجميلة",
    "📖 مرحباً... هنا نتناقش في أمور الروح والإيمان بكل احترام",
]

# رسائل فلسفية عميقة ومضحكة
PHILOSOPHY_MESSAGES = [
    "🤔 أهلاً بأفلاطون العصر! جهز مخك لنقاش فلسفي عميق (أو محير 😵)",
    "🧠 مرحباً بالمفكر! هنا رح نفلسف حتى في أبسط الأشياء!",
    "💭 دخل الحكيم! بس لا تفلسفلي موضوع الفلافل... خلاص تعقدت 😂",
    "🌌 الوجود... العدم... المعنى... أكيد رح نطلع من هون ومخنا معقود!",
    "🤯 فلسفة؟ يعني بدنا نفكر بأشياء تخلي مخنا يعمل ريستارت كل شوية؟",
    "🧙‍♂️ أهلاً بسقراط الجديد! بس ما تسألني أسئلة تخليني أشك بوجودي 😅",
]

# رسائل اجتماعية وتعارف
SOCIAL_MESSAGES = [
    "💬 أهلاً بالاجتماعي! هنا نتعرف ونحكي... بس بأدب يا معلم!",
    "🤝 حياك... التعارف فن، والكلام الحلو مفتاح القلوب!",
    "😊 مرحباً بك... يلا نتعرف على بعض وندردش دردشة حلوة!",
    "🌟 أهلين... كل واحد عنده حكايته، شاركنا حكايتك!",
    "💫 التعارف أول خطوة للصداقة... أو للندم أحياناً 😂",
    "🎈 مرحبا... خلينا نعرف بعض ونضحك شوي على هالحياة!",
]

# رسائل عامة متنوعة
GENERAL_MESSAGES = [
    "🌈 موضوع عام؟ يعني كل شي ممكن يصير... استعد للمفاجآت!",
    "🎪 عام وشامل! من الألف للياء، كله مسموح (المهذب طبعاً 😉)",
    "🎯 بدون تخصص؟ حلو... معناتها رح نطير في كل اتجاه!",
    "🌍 العالم مفتوح قدامك... احكي عن اللي بخاطرك!",
    "🎭 موضوع عام = مفاجآت عامة! يلا نشوف وين رح توصلنا الدردشة!",
]

def get_welcome_message(topic=None):
    if topic == "START":
        return random.choice(START_MESSAGES)
    if not topic:
        return random.choice(START_MESSAGES)
    
    t = topic.lower()
    if "رياض" in t or "⚽" in topic or "كرة" in t or "football" in t.lower():
        return random.choice(FOOTBALL_MESSAGES)
    elif "سياس" in t or "politics" in t.lower():
        return random.choice(POLITICS_MESSAGES)
    elif "دين" in t or "religion" in t.lower() or "إسلام" in t:
        return random.choice(RELIGION_MESSAGES)
    elif "فلسف" in t or "philosophy" in t.lower():
        return random.choice(PHILOSOPHY_MESSAGES)
    elif "تعارف" in t or "social" in t.lower() or "اجتماع" in t:
        return random.choice(SOCIAL_MESSAGES)
    elif "عام" in t or "general" in t.lower():
        return random.choice(GENERAL_MESSAGES)
    else:
        return random.choice(START_MESSAGES)

# webhook-safe send (no sleep)
def delayed_send(bot, chat_id, text, **kwargs):
    # remove delay if provided mistakenly
    kwargs.pop("delay", None)
    try:
        bot.send_message(chat_id, text, **kwargs)
    except Exception as e:
        print(f"[delayed_send ERROR] {e} | chat_id={chat_id} | text_preview={str(text)[:120]}")
