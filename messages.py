# messages.py (استبدال دالة delayed_send الحالية)
import random
import time

def delayed_send(bot, chat_id, text, delay=None, **kwargs):
    """
    Webhook-safe: نقبل delay للتماشي مع استدعاءات قديمة،
    لكن لا نمرِّر delay إلى bot.send_message لأن هذه الدالة لا تقبله.
    كما نعالج الأخطاء ونطبع لوج واضح.
    """
    # لا تمرّر delay إلى send_message
    if 'delay' in kwargs:
        kwargs.pop('delay', None)
    try:
        # لاحظ: لا نقوم بـ time.sleep هنا (ويبهوك يجب أن يرد بسرعة).
        bot.send_message(chat_id, text, **kwargs)
    except Exception as e:
        print(f"[SEND_MESSAGE ERROR] {e} | chat_id={chat_id} | text_preview={str(text)[:120]}")
        
# ============ رسائل البداية / ستارت ============
START_MESSAGES = [
    "😂 أهلاً أهلاً… حضّر نفسك، يمكن تضحك أو يمكن تندم على دخولك!",
    "😏 هلا بك! هذا البوت مثل حلبة مصارعة… بس بالسوالف والنكت.",
    "🙃 دخلت عالم السؤال… كل شيء ممكن يحدث، حتى ضحك على غرائب نفسك!",
    "🔥 هلا! لا تشيل هم، كل اللي راح يسوي لك البوت هو إنه يوصلك لشخص غريب يناقشك في مواضيعك.",
    "😂 حبيبي، انتبه: بعض الناس هون ممكن ينكتوا على طول… وبعضهم على حسابك!",
    "لقد وصلت الى طريق مسدود.. بس منفتحو كرمالك 😎",
    "تفضل يا مولاي...",
    "اي تفضل تفضل تفضل ❤️❤️"
]

# ============ الرسائل الرياضية (كرة القدم) ============
FOOTBALL_MESSAGES = [
    "⚽ دخلت عالم الكرة… هل أنت مع برشلونة؟ أو هل فريقك سيخسر أمام ريال مدريد مرة أخرى 😅",
    "🏆 ليفربول يا غالي! حضر شايك، المباراة الكلامية بدأت 😉",
    "🔥 بايرن ميونيخ يدخل الدوري… أو على الأقل في حديثك مع شريكك 😎",
    "⚡ مانشستر يونايتد يطالب بالاحترام… هل ستحصل عليه في النقاش؟",
    "🤣 باريس سان جيرمان: حتى لو النقاش قصير، الضحك مضمون!",
    "⚽ تشيلسي ولا آرسنال؟ اختر فريقك، الباقي على المزاج 😏",
    "🏟️ ريال مدريد يدخل الملعب… لكن شريكك يمكن يكون مع برشلونة 😜",
    "🎯 جوفنتوس يحاول التسجيل… لكن النقاش الفلسفي قد يسرق الكرة منك!",
    "😂 إنتر ميلان؟ ممكن يكون شريكك… أو مجرد مدافع صامت 😅",
    "⚡ ميلان ضد نابولي… النقاش محتدم والضحك حاضر!"
]

# ============ الرسائل السياسية ============
POLITICS_MESSAGES = [
    "🌍 اهلاً في ساحة السياسة… هل الحكومات تخبرنا كل الحقيقة؟",
    "🕵️‍♂️ بعض المؤامرات غريبة… قد تكون صحيحة، أو مجرد تخيلات!",
    "🏛️ العالم مليء بالدول التي تتحرك خلف الكواليس… أي واحدة ستختار للنقاش؟",
    "📰 أخبار اليوم تثير التساؤل… هل نحن أحرار حقًا؟",
    "⚖️ النقاش السياسي قد يغير أفكارك… هل أنت مستعد للتساؤل العميق؟",
    "🌐 كل دولة لها مصالحها… لكن هل المصالح دائمًا واضحة؟",
    "📜 التاريخ مليء بالمؤامرات الكبرى… بعض الأسئلة لا تجد إجابة!",
    "💬 السياسة ليست فقط حكام… بل الناس، والشائعات، والأفكار!",
    "🗺️ من الشرق إلى الغرب، كل دولة لها قصة… هل تعرف القصة الكاملة؟",
    "🔎 النقاش السياسي يكشف عوالم مجهولة… استعد للتفكير العميق."
]

# ============ الرسائل الدينية ============
RELIGION_MESSAGES = [
    "🕌 أهلاً بك… هنا نناقش الدين والأفكار بحكمة، مع احترام الجميع.",
    "✝️ اليهودية، المسيحية، الإسلام… كلنا نتشارك في فضاءات التعلم والاحترام.",
    "☪️ الحوار الديني يبدأ بالفهم… وينتهي بالتعايش والسلام.",
    "📿 الإلحاد والفكر الحر موجود أيضًا… لنحترم كل الآراء.",
    "🕊️ هدف النقاش هو الحكمة، لا الإلزام… أطرح أفكارك بأمان.",
    "⛪ اختلافنا في المعتقدات يعلّمنا التواضع والصبر على الآخر.",
    "🛐 أسس العقلاء: الاستماع قبل الرد… الاحترام فوق كل شيء.",
    "🙏 كل نقاش ديني فرصة للتقارب بين البشر، لا للفرقة.",
    "☮️ أحيانًا نختلف في الرأي، لكن يجمعنا الإنسانية والرحمة.",
    "🕋 الحوار البنّاء يعزز المعرفة والتسامح… هنا مكانك لتبادل الأفكار."
]

# ============ الرسائل الفلسفية ============
PHILOSOPHY_MESSAGES = [
    "🤔 ما معنى أن تكون موجودًا؟ هل الوجود مجرد صدفة أم اختيار؟",
    "🧠 كل فكرة نملكها هي انعكاس لذاتنا… هل تعرف من أنت فعلاً؟",
    "📚 'أنا أفكر، إذن أنا موجود'… لكن من يراقب التفكير؟",
    "💭 أحيانًا السؤال أهم من الجواب… هل تبحث عن الحقيقة أم المتعة؟",
    "🎩 الفلسفة مثل القهوة، أحيانًا مرة، أحيانًا غريبة… لكن لا تستطيع الاستغناء عنها.",
    "⚡ هل الوقت خط وهمي؟ أم أن الماضي والحاضر والمستقبل مجرد لعبة عقل؟",
    "🌀 هل نحن نختار أفكارنا؟ أم هي تأتي إلينا بلا استئذان؟",
    "🤣 حتى سقراط كان يضحك على نفسه… وأنت؟ هل تستطيع أن تسخر من فلسفتك؟",
    "📜 الكون مليء بالأسرار… والفكر الإنساني يحاول فقط الإمساك بها.",
    "🧐 أحيانًا التجربة أهم من النظرية… هل تعيش الفلسفة أم تدرسها فقط؟"
]

# ============ رسائل التعارف / الرومانسية ============
SOCIAL_MESSAGES = [
    "💬 مرحبًا بك… البشر خلقوا للتعارف، لنحترم بعضنا ونتعلم من بعضنا.",
    "❤️ التواصل بين البشر يختلف عن كل الكائنات الأخرى… هنا تبدأ الرحلة!",
    "🤝 كل شخص يملك قصة… هل أنت مستعد لسماعها ومشاركتها؟",
    "🌍 'خلقناكم شعوبًا وقبائل لتعارفوا'… اختر شريكك للحديث اللطيف.",
    "✨ الاحترام هو أساس كل محادثة… ضحكة واحدة يمكن أن تصنع يومك!",
    "🥰 ربما تجد صديقًا أو مجرد لحظة سعادة… كل شيء ممكن في النقاش.",
    "💭 الحيوانات تتواصل، لكن البشر يعقلون… فلنستخدم العقل واللطف معًا.",
    "🌹 هنا لكل حديث قيمة… ولو كانت مجرد ابتسامة على الشاشة.",
    "😊 المحادثة الصحيحة تُشعر بالدفء… كل كلمة تُبنى بعناية واحترام.",
    "💌 تعارف لطيف، مزاح خفيف، وأفكار جميلة… هذه مهمتنا معًا."
]

# ============ الرسائل الخاصة بالعمليات ============
WELCOME = "🎉 مرحبًا بك! استخدم الأزرار للبدء."
HELP = (
    "🆘 <b>مساعدة</b>\n"
    "• 👤 ملفي — عرض بياناتك.\n"
    "• ✏️ تعديل الاسم / 🎂 تعديل العمر.\n"
    "• 🔍 البحث عن دردشة — تختار موضوعًا + جنس الطرف الآخر ثم نبحث لمدة 30 دقيقة.\n"
    "• أثناء الدردشة: 🚨 إبلاغ، 🚪 مغادرة (بعد 30 ثانية) مع تأكيد.\n"
)

SEARCHING = "⏳ جاري البحث عن شريك مناسب… ابقَ هنا أو عد للقائمة، سنخبرك إن وجدنا شريكًا."
NO_MATCH = "❌ لم نجد لك شريكًا خلال 30 دقيقة. جرّب مرة أخرى لاحقًا."
INTRO_PARTNER = (
    "✅ <b>تم العثور على شريك للدردشة!</b>\n"
    "✨ تذكير: لا تُظهر أي معلومات حساسة، واحترم الطرف الآخر.\n"
    "ابدأ الحديث بلطف 🙂"
)

LEAVE_CONFIRM = "⚠️ هل تريد مغادرة الدردشة؟\nاختر: نعم ✅ / لا ❌"
LEAVE_TOO_SOON = "⏳ يمكنك المغادرة بعد {remain} ثانية."
LEFT_YOU = "🚪 تم إنهاء الدردشة. عدتَ إلى القائمة الرئيسية."
LEFT_PARTNER = "ℹ️ أنهى الطرف الآخر الدردشة. يمكنك بدء محادثة جديدة."

REPORT_CONFIRM = "🚨 هل تريد إرسال بلاغ لمراجعة آخر 50 رسالة؟ نعم ✅ / لا ❌"
REPORT_OK = "✅ تم استلام البلاغ وسنراجع المحادثة."
REPORT_RESULT = "🔎 نتيجة المراجعة:\n{lines}\n\nتذكير: الاحترام الحالي لديك ⭐ {respect}."
MUTED = "⏳ أنت تحت حظر جزئي حتى انتهاء المدة (~{left} ثانية)."
BANNED = "🚫 حسابك محظور بسبب مخالفات متكررة."

# ============ دالة اختيار رسالة الترحيب ============
def get_welcome_message(topic=None):
    if topic == "START":
        return random.choice(START_MESSAGES)
    if not topic:
        return random.choice(START_MESSAGES)

    t = topic.lower()

    if "رياض" in t or "⚽" in topic:
        return random.choice(FOOTBALL_MESSAGES)
    if "سياس" in t or "🏛" in topic:
        return random.choice(POLITICS_MESSAGES)
    if "دين" in t or "🕌" in topic:
        return random.choice(RELIGION_MESSAGES)
    if "فلسف" in t or "🎭" in topic:
        return random.choice(PHILOSOPHY_MESSAGES)
    if "تعارف" in t or "🤝" in topic:
        return random.choice(SOCIAL_MESSAGES)

    return random.choice(START_MESSAGES)
    
